# FileFlow 战略路线图 (TODO)

> 打造世界一流的智能文件管理系统

---

## 🎯 Phase 1: 核心体验打磨 (v1.1) ✅ 完成

### 性能优化
- [x] **SQLite 连接池**: 使用 WAL 模式和性能优化 pragmas
- [x] **懒加载优化**: `CategoryView` 分页加载
- [x] **缓存层**: 添加内存缓存 (TTL 自动过期)
- [x] **增量索引**: 文件变更时仅更新差异

### 稳定性
- [x] **错误边界**: AI 调用重试机制 (指数退避 + 抖动)
- [x] **事务回滚**: 文件移动失败时自动恢复
- [x] **日志系统**: OSLog 集成 + 导出诊断日志 UI
- [ ] **崩溃恢复**: 检测上次异常退出，恢复未完成任务

---

## 🚀 Phase 2: 智能进化 (v1.2) ✅ 完成

### AI 增强
- [x] **多模态分析**: 图片 OCR、PDF 提取、音频转写
- [x] **语义搜索**: NLEmbedding 向量搜索
- [x] **智能去重**: SHA256 内容指纹检测
- [x] **自动归档规则**: RuleEngine + 预置模板
- [x] **学习用户习惯**: UserFeedbackService

### 标签系统
- [x] **标签层级**: parent_id 嵌套结构
- [x] **智能标签合并**: Levenshtein 距离检测
- [x] **跨文件标签传播**: 相似文件继承标签
- [x] **标签热力图**: Swift Charts 可视化

---

## 📁 PARA 生命周期管理 ✅ 完成

> 基于 `PARA-Lifecycle-Design.md` 设计文档

### 已完成功能
| 功能 | 状态 | 实现 |
|------|------|------|
| 生命周期状态枚举 | ✅ | `FileLifecycleStage` (active/dormant/stale/archived) |
| 流转记录模型 | ✅ | `FileTransition` + `TransitionReason` |
| 文件最后访问时间 | ✅ | `lastAccessedAt` 字段 + 自动更新 |
| 生命周期服务 | ✅ | `LifecycleService.shared` |
| 定时后台扫描 | ✅ | 30分钟周期扫描 + 启动时刷新 |
| 规则引擎扩展 | ✅ | `lastAccessDays`, `lifecycleStage` 条件 |
| 5个预置规则 | ✅ | 过期项目归档、未用资源提醒等 |
| 首次启动自动创建规则 | ✅ | `setupPresetRulesIfNeeded()` |
| 项目归档向导 UI | ✅ | `ProjectArchiveWizard` |
| 清理建议视图 | ✅ | `CleanupSuggestionsView` |
| 流转历史时间线 | ✅ | `FileTransitionHistoryView` + 撤销按钮 |
| AI 可复用资源识别 | ✅ | 增强版 `detectReusableAsset` (7种规则) |
| 流转撤销支持 | ✅ | `undoTransition()` + 24h限制 |
| 统计仪表盘 | ✅ | `LifecycleDashboardView` |

---

## 🏆 Phase 5: 知识管理 (v3.0) 🟡 部分完成

### 知识关联与发现 ✅ 完成
- [x] **双向链接**: `KnowledgeLinkService`
- [x] **反向搜索**: `reverseSearch()`
- [x] **知识卡片**: RAG 内容分析 + 间隔重复
- [x] **自动摘要链**: `generateSummaryChain()`
- [x] **上下文推荐**: `getContextRecommendations()` + UI 集成

### 时间维度管理 ✅ 完成
- [x] **回顾系统**: 每日/每周/每月知识回顾提醒
- [x] **遗忘曲线**: 艾宾浩斯复习提醒算法
- [x] **时间胶囊**: 设定未来日期解锁文件
- [x] **活动日历**: 日历视图展示文件活动

### 智能整理助手 ✅ 完成
- [x] **统一入口**: `SmartOrganizeView` 全页面视图
- [x] **AI 文件夹分析**: 检测语义相似的文件夹并建议合并
- [x] **AI 标签分析**: 智能识别同义标签并建议合并
- [x] **状态持久化**: ViewModel 全局持久化，分析状态不丢失
- [x] **一键执行**: 支持单条建议快速合并操作

---

## 🌐 Phase 3: 生态扩展 (v1.3) ❌ 待开发

### 多端同步
- [x] **iCloud 同步**: 数据库和配置跨设备同步
- [ ] **Conflict Resolution**: CRDT 智能合并冲突
- [ ] **离线优先**: 完整离线功能

### 集成能力
- [ ] **Finder Extension**: 右键菜单快速归档
- [x] **URL Scheme**: `fileflow://open?tag=xxx`
- [ ] **Raycast/Alfred 插件**: 快速搜索操作

### 导入导出
- [x] **批量导出**: JSON 备份
- [ ] **Obsidian 兼容**: Markdown 链接生成

---

## 🎨 Phase 4: 极致体验 (v2.0) 🟡 部分完成

### 交互革新
- [x] **拖拽增强**: 显示落点预览和影响范围
- [ ] **手势支持**: 触控板滑动、捏合缩放
- [x] **主题切换**: 暗黑/浅色 + 自定义 Accent Color

### 可视化
- [x] **时间线视图**: 流转历史时间线
- [x] **目录树地图**: Treemap 磁盘占用可视化
- [x] **知识图谱**: TagGraphView 力导向图
- [x] **活动仪表盘**: LifecycleDashboardView

### 高级功能
- [ ] **版本控制**: Git-like 文件历史快照
- [ ] **协作共享**: 临时分享链接
- [ ] **敏感信息检测**: AI 识别隐私文件
- [x] **存储分析**: 首页集成核心指标
- [x] **自适应布局**: 首页响应式支持侧边栏收起/展开

### 系统级集成 (新增)
- [x] **命令面板**: Cmd+Shift+P 万能命令
- [x] **CoreSpotlight 索引**: macOS Spotlight 可搜索元数据
- [x] **自然语言查询**: "找上周的PDF" 智能解析

---

## 📖 深度集成 ❌ 待开发

| 功能 | 优先级 | 复杂度 | 说明 |
|------|--------|--------|------|
| PDF 阅读器 + 标注 | ✅ 完成 | 高 | 内置阅读器，支持高亮和笔记 |
| PDF 标注提取 | ✅ 完成 | 中 | 一键提取高亮为知识卡片 |
| 浏览器插件 | 🟡 中 | 高 | 一键保存网页到 FileFlow |
| 邮件归档 | 🟡 中 | 中 | Apple Mail 导入 |
| 截图工具 | 🟢 低 | 低 | 全局快捷键截图 + OCR |
| 剪贴板历史 | 🟢 低 | 中 | 智能保存复制内容 |

---

## 🔬 技术债务清理 ❌ 待开发

| 任务 | 优先级 |
|------|--------|
| 单元测试覆盖核心服务 | 🔴 高 |
| XCUITest 覆盖主流程 | 🟡 中 |
| SwiftLint 代码风格 | 🟢 低 |
| DocC 文档注释 | 🟢 低 |
| 依赖注入替换 Singleton | 🟡 中 |
| 模块拆分 Swift Package | 🔴 高 |
| 所有 View 添加 #Preview | 🟢 低 |

---

## 💡 创新实验

| 想法 | 描述 | 优先级 |
|------|------|--------|
| 🧠 本地 LLM | llama.cpp 完全离线 AI | 中 |
| 🎙️ 语音助手 | "帮我找上周的合同" | 低 |
| 📱 iOS 配套 | 移动端查看搜索 | 高 |
| 🤖 Agent 模式 | AI 自主整理，人类审批 | 中 |

---

## 📊 成功指标

| 指标 | 目标 | 当前状态 |
|------|------|----------|
| 启动速度 | < 1s | ✅ 达成 |
| 批量处理 | 1000 文件/分 | ✅ 达成 |
| AI 响应 | < 3s | ✅ 达成 |
| 内存占用 | < 200MB | ✅ 达成 |
| 崩溃率 | < 0.1% | 🟡 待验证 |

---

## 📈 完成度统计

| 模块 | 完成度 |
|------|--------|
| Phase 1 核心体验 | 95% |
| Phase 2 智能进化 | 100% |
| PARA 生命周期 | 100% |
| Phase 5 知识管理 | 100% |
| Phase 3 生态扩展 | 10% |
| Phase 4 极致体验 | 50% |
| 技术债务 | 20% |

**总体完成度: ~70%**

---

*"简洁是复杂的结晶" — 将复杂的文件管理，化为优雅的一键操作*